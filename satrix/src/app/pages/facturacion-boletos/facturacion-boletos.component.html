<main class="contenido">
  <h2>FacturaciÃ³n de Boletos</h2>

  <form class="formulario-factura" (ngSubmit)="enviarFormulario()" #formulario="ngForm">

    <!-- TOKEN PRIMERO -->
    <label for="token">Token de Boleto:</label>
    <input id="token" name="token" type="text" [(ngModel)]="token" required />
    <p class="error" *ngIf="tokenInvalid">El token no puede estar vacÃ­o.</p>

    <label for="imagenBoleto">Sube la imagen del boleto:</label>
    <input type="file" id="imagenBoleto" (change)="onArchivoSeleccionado($event)" accept="image/*" />
    <button type="button" (click)="analizarImagen()">Leer token automÃ¡ticamente</button>

    <p class="resultado-token" *ngIf="tokenExtraido">
      Token detectado: <strong>{{ tokenExtraido }}</strong>
    </p>

    <!-- RFC DESPUÃ‰S -->
    <label for="rfc">RFC:</label>
    <input id="rfc" name="rfc" type="text" [(ngModel)]="rfc" required />
    <p class="error" *ngIf="rfcInvalid">El RFC debe tener entre 12 y 13 caracteres.</p>

    <label for="documentoRFC">Sube tu constancia fiscal:</label>
    <input type="file" id="documentoRFC" (change)="onDocumentoRFCSeleccionado($event)" accept=".pdf,image/*" />
    <button type="button" (click)="analizarRFC()">Leer RFC automÃ¡ticamente</button>

    <p class="resultado-token" *ngIf="rfcExtraido">
      RFC detectado: <strong>{{ rfcExtraido }}</strong>
    </p>

    <!-- MODAL -->
    <div class="modal" *ngIf="mostrarEjemplo" (click)="mostrarEjemplo = false">
      <div class="modal-contenido" (click)="$event.stopPropagation()">
        <img src="assets/ticket-boleto.PNG" alt="Ejemplo de ticket" />
        <button class="cerrar" (click)="mostrarEjemplo = false">âœ–</button>
      </div>
    </div>

    <button type="submit" class="btn-btn-primario">Facturar</button>
  </form>

  <!-- ASISTENTE -->
  <div class="boton-asistente" (click)="toggleAsistente()">ðŸ’¬</div>

  <div class="contenedor-asistente" *ngIf="asistenteVisible">
    <app-asistente-virtual [mensaje]="mensajeAsistente"></app-asistente-virtual>
    <div class="acciones-asistente">
      <button (click)="accionRFC()">Â¿No conoces tu RFC?</button>
      <button (click)="accionToken()">Â¿No encuentras el token?</button>
    </div>
  </div>
</main>
